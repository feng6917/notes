#### MySQL 必知必会

```
    该书主要是 描述了 MySQL 的一些基本知识、概念。
```

- 数据库（database） 保存有组织的数据的容器（通常是一个文件或一组文件）。
- 表(table)  某种特定类型数据的结构化清单。
- 模式（schema） 关于数据库和表的布局及特性的信息。
- 列（column） 表中的一个字段。所有表都是由一个或多个列组成的。
- 数据类型（datatype）所容许的数据的类型。每个表列都有相应的数据类型，它限制（或容许）该列中存储的数据。
- 行（row） 表中的一个记录。
- 主键（primary key）一列（或一组列），其值能够唯一区分表中每个行。
- SQL是结构化查询语言（structured query language）的缩写。SQL是一种专门与数据库通信的语言。
- 使用MySQL 原因
  - 成本（开源、免费使用）
  - 性能 （执行快）
  - 可信赖
  - 简单 （易于安装、部署）
- 连接MySQL，需要一下信息
  - 主机（计算机名）本地 local host
  - 端口 默认 3306
  - 一个合法的用户名
  - 用户口令
- 结束SQL语句 多条SQL语句碧血以分号（；）分割。
- SQL语句和大小写 SQL语句不区分大小写，因此SELECT与select是相同的。
- 使用空格 在处理SQL语句中，其中所有空格都被忽略。
- 当心逗号 在选择多个列时，一定要在列名之间加上逗号，但是最后一个列名后不加。
- 使用通配符 一般，除非你确实需要表中的每个列，否则最好别使用*通配符。不明确列出所需列，通常会降低检索和应用程序的性能。
- 检索未知列 使用通配符有一个大优点。
- 不能部分使用DISTINCT DISTINCT关键字应用于所有列而不仅时前置它的列。
- 行0 检索出来的第一行为行0而不是行1。因此LIMIT 1，1 将检索出第二行而不是第一行
- 在行数不够时 LIMIT中指定要检索的最大行数。
- 在多个列降序排序 如果想在多个列上进行降序排序，必须对每个列指定DESC关键字。
- ORDER BY子句的位置  在给出ORDER　BY子句时，应该保证它位于FROM子句之后。
- WHERE子句的位置　在同时使用ORDER BY和WHERE子句时，应该让ORDER BY位于WHERE子句之后。
- 操作符
  - = 等于
  - <> 不等于
  - ！= 不等于
  - < 小于
  - <= 小于等于
  - > 大于
  - >= 大于等于
  - BETWEEN 在指定的两个值之间

- 何时使用引号 如果将值与串类型的列进行比较，则需要引号。用来与 数值列进行比较的值不用引号。
- NULL与不匹配 在通过过滤选择出不具有特定值的行时，你可能希望返回具有NULL值得行。但是，不行。应为未知具有特殊得含义，数据库不知道他们是否匹配，所以在匹配过滤或不匹配过滤时不返回它们。
- AND 用在WHERE子句中的关键字，用于指示检索满足所有给定条件的行。
- OR WHERE子句中使用的关键字，用于表示检索匹配任一给定条件的行。
- IN WHERE子句中用来指定要匹配值得清单得关键字，功能与OR相当。
- NOT WHERE子句中用来否定后跟条件的关键字。
- 通配符 用来匹配值的一部分的特殊字符。
- 搜索模式 由字面值、通配符或两者组合构成的搜索条件。
- 区分大小写 根据MySQL的配置方式，搜索可以是区分大小写的。如果区分大小写，‘jet%’与JetPack将不匹配。
- 注意尾空格 尾空格可能会干扰通配符匹配。
- 注意NULL 虽然似乎%通配符可以匹配任何东西，但有一个例外，即NULL。
- 使用通配符的技巧
  - 不要过度使用通配符。
  - 在确实需要使用通配符时，除非绝对必要，否则不要把他们用在搜索模式的开始处。置于开始处，搜索慢。
  - 仔细注意通配符的位置。
- 匹配\ 为了匹配反斜杠\ 字符本身，需要使用\\.
- \或者\\? 多数正则表达式实现使用单个反斜杠转义特殊字符，以便能使用这些字符本身。
- ^的双重用途 ^有两种用法。在集合中（用[和]定义），用它否定该集合，否则，用来指串的开始处。
- 字段 基本上与列的意思相同，经常互换使用，不过数据库列一般称为列，而术语字段通常用在计算字段的连接上。
- 拼接 将值联结到一起构成单个值。
- 多数DBMS使用+或者||来实现拼接，MySQL则使用Concatenate（）函数来实现。当把SQL语句转换成MySQL语句时一定要把这个区别铭记在心。
- Trim函数 MySQL除了支持RTrim()(去掉串右边的空格)，还支持LTrim()(去掉串左边的空格)以及Trim（去掉串左右两边的空格）。
- 别名的其他用途 常见的用途包括在实际的表列名包含不符合规定的字符（如空格）时重新命名它，在原来的名字含混或容易误解时扩充它，等等。
- 导出列 别名有时也称为导出列，不管称为什么，他们所代表的都是相同的东西。
- 常用的文本处理函数
  - Left() 返回串左边的字符
  - Length() 返回串的长度
  - Locate() 找出串的一个字串
  - Lower() 将串转换为小写
  - LTrim() 去掉串左边的空格
  - Right() 返回串右边的字符
  - RTrim() 去掉串右边的空格
  - Soundex() 返回串的SOUNDEX值 （是将任何文本串转换为描述其语言表示的字母数字模式的算法）
  - SubString() 返回字串的字符
  - Upper() 将串转换为大写

- 应该总是使用4位数字的年份 支持2位数字的年份，处理00-69为2000-2069，处理70-99为1970-1999.虽然他们可能是打算要的年份，但使用完整的4位数字年份更可靠，因为MySQL不需要作出任何假定。
- 聚集函数 运行在行组上，计算和返回单个值得函数。
- 只用于单个列 AVG（）智能用来确定特定数值列得平均值，而且列名必须作为函数参数给出。
- NULL 值 AVG（）函数、MAX（）函数、MIN（）函数 SUM（）函数 忽略列值为NULL得行。如果指定列名，则指定列得值为空得行被COUNT（）函数忽略，但如果COUNT（）函数中用得是星号（*），则不忽略。
- 取别名 在指定别名以包含某个聚集函数得结果时，不应该使用表中实际得列名。虽然这样做并不合法，但使用唯一得名字会使你得SQL更易于理解和使用（以及将来容易排除故障）。
- HAVING和WHERE得区别　WHERE在数据分组前进行过滤，HAVING在数组分组后进行过滤。
- 查询 任何SQL语句都是查询。
- 格式化SQL　包含子查询得SELECT语句难以阅读和调试，特别是它们较为复杂时更是如此。把子查询分解为多行并且适当地进行缩进，能极大地简化子查询得使用。
- 列必须匹配 在WHERE子句中使用子查询，应该保证SELECT语句具有与WHERE子句中相同数目的列。
- 外键 外键为某个表中的一列，它包含另一个表中的主键值，定义了两个表之间的关系。
- 可伸缩性 能够适应不断增加的工作量而不失败。设计良好的数据库或应用程序称之为可伸缩性好（scale well）。
- 完全限定列名 在引用的列可能出现二义性时，必须使用完全限定列名（用一个点分割的表名和列名）。
- 笛卡儿积 由没有联结条件的表关系返回的结果为笛卡儿积。
- 不要忘了WHERE子句 应该保证所有联结都有WHERE子句，否则MySQL将返回比想要的数据多得多的数据。
- 性能考虑 MySQL在运行时关联指定的每个表以处理联结。这种处理可能是非常耗费资源的，因此应该仔细，不要联结不必要的表。联结的表越多，性能下降越厉害。
- 多做实验 为执行任一给定的SQL操作，一般存在不止一种方法。很少由绝对正确或绝对错误的方法。性能可能会受操作类型、表中数据量、是否存在索引或键以及其他一些条件的影响。因此，有必要对不同的选择机制进行试验，以找出最适合具体情况的方法。
- 自联结通常作为外部语句用来替代从相同表中检索数据时使用的子查询语句。
- UNION与WHERE　UNION几乎总是完成与多个WHERE条件相同的工作，UNION ALL为UNION的一种形式，它完称WHERE子句完成不了的工作。如果确定需要每个条件的匹配行全部出现（包括重复行），则必须使用UNION ALL而不是WHERE。
- 搜索不区分大小写 除非使用BINARY方式，否则全文本搜索不区分大小写。
- 提高整体性能 如果数据检索时最重要的，则既可以通过在INSERT和INTO之间添加关键字LOW_PRIORITY，指示MySQL降低INSERT语句的优先级（INSERT　LOW_PRIORITY　INTO），同时适用于UPDATE和DELETE语句。
- 提高INSERT的性能 用单挑INSERT语句处理多个插入比使用多条INSERT语句快。
- 更快的删除 如果想从表中删除所有行，不要使用DELETE。可使用TRUNCATE TABLE语句，它完成相同的工作，但速度更快（TRUNCATE实际是删除原来的表并重新创建一个表，而不是逐行删除表中的数据）。
- 理解NULL NULL没有值，不是空串，主键只能使用不允许NULL值得列。允许NULL值得列不能作为唯一标识。
- 使用默认值而不是NULL值 许多数据库开发人员使用默认值而不是NULL列，特别是对用于计算或数据分组的列更加如此。
- 引擎
  - InnoDB 是一个可靠的事务处理引擎，它不支持全文本搜索。
  - MyISM 是一个性能极高的引擎，它支持全文本搜索，但不支持事务处理。

- 创建可重用的视图 创建不受特定数据限制的视图是一种好办法。
- 变量 内存中一个特定的位置，用来临时存储数据。变量名 所有MySQL变量名都必须以@开始。
- 事务 指一组SQL语句。
- 回退 指撤销指定SQL语句的过程。  
- 提交 指将未存储的SQL语句结果写入数据库表。
- 保留点 指事务处理中设置的临时占位符，你可以对它发布回退（与回退整个事务处理不同）。
- 隐含事务关闭 当COMMIT或ROLLBACK语句执行后，事务会自动关闭（将来的更改会隐含提交）。
- 字符集 为字母和符号的集合；
- 编码 为某个字符集成员的内部表示。
- 校对 为规定字符如何比较的指令。
- 首先刷新未写数据 为了保证所有数据被写到磁盘（包括索引数据），可能需要在进行备份前使用FLUSH TABLES语句。
- 性能优化
  - MySQL是用一系列的默认设置预先配置的，过一段时间后你可能需要调整内存分配，缓冲区大小等。（为查看当前设置，可使用SHOW VARIABLE；和SHOW STATUS;）
  - MySQL一个多用户多线程的DBMS，换言之，它经常同事执行多个任务。如果这些任务中的某一个执行缓慢，则所有请求都会执行缓慢。如果呢遇到显著的性能不良，可使用SHOW PROCESSLIST显示所有活动进程（以及它们的线程ID和执行时间）。你可以用KILL命令终结某个特定的进程.
  - 总有不止一种方法编写同一条SELCECT语句。应该试验联结、并、子查询等，找出最佳的方法。
  - 使用EXPLAIN语句让MySQL解释它将如何执行一条SELECT语句。
  - 一般来说，存储过程执行的比一条一条地执行其中的各条MySQL语句快。
  - 应该总是使用正确的数据类型。
  - 决不要检索比需求还要多的数据。换言之，不要用SELECT * （除非你真正需要每个列）。
  - 有的操作（包括INERT）支持一个可选的DELAYED关键字，如果使用它，将把控制立即返回给调用程序，并且一旦有可能就实际执行该操作。
  - 在导入数据时，应该关闭自动提交。你可能还想删除索引（包括FULLTEXT索引），然后在导入完成后再重建他们。
  - 必须索引数据库表以改善数据检索的性能，确定索引什么不是一件微不足道的任务，需要分析使用的SELECT语句以找出重复的WHERE和ORDER　BY子句。如果一个简单的WHERE子句返回结果所花的时间太长，则可以断定其中使用的列（或几个列）就是需要索引的对象。
  - 你的SELECT语句中有一系列复杂的OR条件吗？通过使用多条SELECT语句和连接他们的UNION语句，你能看到极大的性能改进。
  - 索引改善数据检索的性能，但损害数据插入，删除和更新的性能。如果你有一些表，他们收集数据且不经常被搜索，则在有必要之前不要索引他们。
  - LIKE很慢。一般来说，最好是使用FULLTEXT而不是LIKE。
  - 数据库是不断变化的实体。一组优化良好的表一会儿可能就面目全非了。由于表的使用和内容的更改，理想的优化和配置也会改变。
  - 最重要的规则就是，每条规则在某些条件下都会被打破。
